(window.webpackJsonp=window.webpackJsonp||[]).push([[168],{401:function(s,a,n){"use strict";n.r(a);var t=n(0),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"mac下lnmp搭建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mac下lnmp搭建"}},[s._v("#")]),s._v(" MAC下LNMP搭建")]),s._v(" "),n("h2",{attrs:{id:"_1-docker安装，略"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-docker安装，略"}},[s._v("#")]),s._v(" 1. docker安装，略")]),s._v(" "),n("h2",{attrs:{id:"_2-拉取镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-拉取镜像"}},[s._v("#")]),s._v(" 2. 拉取镜像:")]),s._v(" "),n("p",[s._v("nginx1.12.2,mysql5.7,php7.2")]),s._v(" "),n("p",[s._v("docker删除所有容器和镜像")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("// 删除容器\ndocker stop $(docker ps -q) & docker rm $(docker ps -aq)\n\n// 删除镜像\n docker rmi $(docker images -q) \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"_2-1-安装mysql"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-安装mysql"}},[s._v("#")]),s._v(" 2.1 安装mysql")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("// 拉取镜像\ndocker pull mysql:5.7\n// 启动容器并设置mysql密码\ndocker run -d -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 -e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" --name alan_mysql mysql:5.7\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("blockquote",[n("p",[s._v("问题1. mysql数据如何存储和备份？")])]),s._v(" "),n("h3",{attrs:{id:"_2-2-安装php"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-安装php"}},[s._v("#")]),s._v(" 2.2 安装php")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker pull php:7.2-fpm\ndocker run -d -v /Users/alanwen/www:/var/www/html -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9000")]),s._v(":9000 --link alan_mysql:mysql --name alan_phpfpm php:7.2-fpm \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("blockquote",[n("p",[s._v("参数说明：\n-v 前面是主机的目录映射容器的目录\nlink：挂上msyql\nMac下要由于权限问题要挂载在用户目录下/Users/alanwen/")])]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),n("p",[s._v("进入到PHP容器 (可以用name也可以用容器id)\ndocker exec alan_phpfpm /bin/bash\n就会到var/www/html 目录，新建一个PHP文件\ntouch test.php\n然后退出容器\nexit\n到主机的 var/nginx/www/html 目录下也出现了个test.php")])]),s._v(" "),n("p",[s._v("进入phpfpm容器安装PHP扩展")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("docker-php-ext-install pdo_mysql（curl ...）\n\n要安装php-redis的话，需要另外下载,执行下面这个命令就可以了，有问就no或者空格就好\npecl install redis && docker-php-ext-enable redis\n\n安装后,查看扩展： php-m\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"_2-3-安装nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-安装nginx"}},[s._v("#")]),s._v(" 2.3 安装nginx")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("docker pull ngixn:1.12.2\ndocker run -d -p 88:80 --name alan_nginx -v /Users/alanwen/www:/var/www/html --link alan_phpfpm:phpfpm --name alan_nginx nginx:1.12.2\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("参数：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("-p:映射80端口\n-v:映射目录，最好和PHP的一样\n-name:容器名\n-link：跟PHP关联\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("修改 Nginx 容器配置让他支持 PHP")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("// 进入容器\ndocker exec -it alan_nginx /bin/bash\n// cd 到 conf 目录\ncd etc/nginx/conf.d/\n修改配置文件 default.conf\nvi default.conf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),n("p",[s._v("// 需要安装vim的话\napt-get update\napt-get install vim")])]),s._v(" "),n("p",[s._v("修改Nignx的PHP配置")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("location "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v(" \\"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("php$ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        root           "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("www"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        fastcgi_pass   phpfpm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        fastcgi_index  index"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("php"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        fastcgi_param "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SCRIPT_FILENAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("www"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("$fastcgi_script_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        include        fastcgi_params"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("nginx重启")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("nginx -s reload\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("// nginx容器目录 /usr/share/nginx/html\n//")]),s._v(" "),n("p",[s._v("访问 localhost:88/test.php")]),s._v(" "),n("p",[s._v("使用docker-compose方法重新编排项目，参见参考资料:")]),s._v(" "),n("hr"),s._v(" "),n("p",[s._v("参考资料：")]),s._v(" "),n("ol",[n("li",[n("p",[n("a",{attrs:{href:"https://github.com/yansongda/docker-compose-LNMP",target:"_blank",rel:"noopener noreferrer"}},[s._v("docker-compose实现LNMP"),n("OutboundLink")],1)])]),s._v(" "),n("li",[n("p",[n("a",{attrs:{href:"https://learnku.com/articles/9200/centos-7-uses-docker-to-build-a-basic-lnmp-environment",target:"_blank",rel:"noopener noreferrer"}},[s._v("CentOS 7 使用 docker 搭建基本的 lnmp 环境"),n("OutboundLink")],1)])]),s._v(" "),n("li",[n("p",[n("a",{attrs:{href:"https://learnku.com/articles/24862",target:"_blank",rel:"noopener noreferrer"}},[s._v("用 Docker 搭建 Laravel 开发环境"),n("OutboundLink")],1)])])]),s._v(" "),n("p",[s._v("4."),n("a",{attrs:{href:"https://github.com/duiying/Docker-LNMP",target:"_blank",rel:"noopener noreferrer"}},[s._v("利用Docker-Compose编排LNMP开发环境"),n("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);